# Maintainer:  Dave Murphy <davem@devkitpro.org>

pkgname=switch-sdl2
pkgver=2.28.5
pkgrel=1
pkgdesc="A library for portable low-level access to a video framebuffer, audio output, mouse, and keyboard (Nintendo Switch port)"
arch=('any')
url="https://libsdl.org"
license=("LGPL")
options=(!strip libtool staticlibs)
makedepends=('switch-pkg-config' 'dkp-toolchain-vars')
depends=('switch-mesa' 'libnx')
source=("${url}/release/SDL2-${pkgver}.tar.gz" "SDL2-${pkgver}.patch")
groups=('switch-portlibs' 'switch-sdl2')

build() {
  cd SDL2-$pkgver

  source /opt/devkitpro/switchvars.sh

  patch -p1 -i $srcdir/SDL2-${pkgver}.patch

  ./configure --prefix="${PORTLIBS_PREFIX}" --host=aarch64-none-elf \
  --disable-shared --enable-static \
  --enable-audio \
  --enable-joystick \
  --disable-power \
  --disable-filesystem \
  --enable-cpuinfo \
  --enable-pthreads \
  --enable-timers \
  --enable-video

  make
}

package() {
  cd SDL2-$pkgver

  source /opt/devkitpro/switchvars.sh

  make DESTDIR="$pkgdir" install

  # remove useless stuff
  rm -r "$pkgdir"${PORTLIBS_PREFIX}/share
}
sha256sums=('d8215b571a581be1332d2106f8036fcb03d12a70bae01e20f424976d275432bc'
            '42687c7ef11a38f677e0c381cdece3a283632a2cc247b6e7e879338d606e53bc')
sha256sums=('d8215b571a581be1332d2106f8036fcb03d12a70bae01e20f424976d275432bc'
            '4ec576d147553c578fc9a03565fbcb7bc6d627f1605c6dec06777782b6269637')
sha256sums=('fe7cbf3127882e3fc7259a75a0cb585620272c51745d3852ab9dd87960697f2e'
            '1a04173291fd9a441cd82f94f4d8a1856acd0a21b1d9c69b9f214274179d8cbe')
sha256sums=('fe7cbf3127882e3fc7259a75a0cb585620272c51745d3852ab9dd87960697f2e'
            'db89ef690e51ff75c6275a88e37ea9bf1efca70d1e3a7c328de50ef8fb118b21')
sha256sums=('fe7cbf3127882e3fc7259a75a0cb585620272c51745d3852ab9dd87960697f2e'
            '1ea2a4c4ecfefa5b05ad82bc42b94bb767a760c3e2f8bf2b320a48d13804c879')
sha256sums=('fe7cbf3127882e3fc7259a75a0cb585620272c51745d3852ab9dd87960697f2e'
            '583477cca10a0f51a85232e60708cd122637b99c9979ab980c8ca6e10825b860')
sha256sums=('fe7cbf3127882e3fc7259a75a0cb585620272c51745d3852ab9dd87960697f2e'
            'd62fa8f6941d850b81ab6182c30834beb97406e1e07047a43e6b10463bcdc44d')
sha256sums=('91e4c34b1768f92d399b078e171448c6af18cafda743987ed2064a28954d6d97'
            '44cd9b2e542c87e60709f21fb8f01783f6c6b435468165d764e26e32381952d5')
sha256sums=('91e4c34b1768f92d399b078e171448c6af18cafda743987ed2064a28954d6d97'
            '2d135c22e104a19c9de0e18cc654bec2f9045f1668b3e6dfba10e670d1731735')
sha256sums=('8000d7169febce93c84b6bdf376631f8179132fd69f7015d4dadb8b9c2bdb295'
            '6f4a91fcb47c8bf27bac7fbf11d537fb91f7baa0749a000c07f1999653412f4d')
sha256sums=('8000d7169febce93c84b6bdf376631f8179132fd69f7015d4dadb8b9c2bdb295'
            '6f4a91fcb47c8bf27bac7fbf11d537fb91f7baa0749a000c07f1999653412f4d')
sha256sums=('332cb37d0be20cb9541739c61f79bae5a477427d79ae85e352089afdaf6666e4'
            '40bff5339d562f38c330857af8754976c0d97e1ffc357d6fcfac7b2bfe8f22a2')
sha256sums=('332cb37d0be20cb9541739c61f79bae5a477427d79ae85e352089afdaf6666e4'
            '118a206a32d60389c79addbed4ef3c00701722ed42b68444785f514ffc18ac76')
sha256sums=('332cb37d0be20cb9541739c61f79bae5a477427d79ae85e352089afdaf6666e4'
            '7bf822fbec16de087dff90cbf21e4b26a410c70fb582d71c554d2385200a3dea')
sha256sums=('332cb37d0be20cb9541739c61f79bae5a477427d79ae85e352089afdaf6666e4'
            '300e902228091c42d2bfc4833b21334b552d2fda38589c826bf99751da4ba00d')
